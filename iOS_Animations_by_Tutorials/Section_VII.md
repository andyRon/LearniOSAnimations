# ç³»ç»Ÿå­¦ä¹ iOSåŠ¨ç”»ä¹‹ä¸ƒï¼šå…¶å®ƒç±»å‹çš„åŠ¨ç”»



å‰é¢å­¦ä¹ å¾ˆå¤šåŠ¨ç”»æ–¹é¢çš„çŸ¥è¯†ï¼Œä½†æœ‰ä¸¤ä¸ªæ›´ä¸“ä¸šçš„ä¸»é¢˜ä¸é€‚åˆå‰é¢çš„ä»»ä½•éƒ¨åˆ†ã€‚



[26-ç²’å­å‘å°„å™¨](#26-ç²’å­å‘å°„å™¨) â€”â€” å­¦ä¹ å¦‚ä½•åˆ›å»ºç²’å­å‘å°„å™¨å¹¶åˆ›å»ºä»¥ä¸‹é™é›ªæ•ˆæœã€‚



[27-UIImageViewçš„å¸§åŠ¨ç”»](#27-UIImageViewçš„å¸§åŠ¨ç”») â€”â€”  é€šè¿‡å°†å¸§åŠ¨ç”»ä¸ä¼ ç»Ÿè§†å›¾åŠ¨ç”»ç›¸ç»“åˆï¼Œåˆ›å»ºç±»ä¼¼å¡é€šçš„æ•ˆæœã€‚



## 26-ç²’å­å‘å°„å™¨



ç€‘å¸ƒï¼Œç«ï¼ŒçƒŸå’Œé›¨çš„å½±å“éƒ½æ¶‰åŠå¤§é‡çš„è§†è§‰é¡¹ç›® â€”â€” ç²’å­ â€”â€” å®ƒä»¬å…·æœ‰å…±åŒçš„ç‰©ç†ç‰¹å¾ï¼Œä½†ä»ç„¶å¯èƒ½æœ‰è‡ªå·±ç‹¬ç‰¹çš„å¤§å°ï¼Œæ–¹å‘ï¼Œæ—‹è½¬å’Œè½¨è¿¹ã€‚

ç²’å­å¯ä»¥å¾ˆå¥½åœ°åˆ›å»ºé€¼çœŸçš„æ•ˆæœï¼Œå› ä¸ºæ¯ä¸ªç²’å­éƒ½å¯ä»¥æ˜¯éšæœºçš„å’Œä¸å¯é¢„æµ‹çš„ï¼Œå°±åƒç‰©ä½“åœ¨è‡ªç„¶ç•Œä¸­ä¸€æ ·ã€‚ä¾‹å¦‚ï¼Œé›·æš´ä¸­çš„æ¯ä¸ªé›¨æ»´å¯èƒ½å…·æœ‰ç‹¬ç‰¹çš„å¤§å°ï¼Œå½¢çŠ¶å’Œé€Ÿåº¦ã€‚



ä»¥ä¸‹æ˜¯**ç²’å­å‘å°„å™¨(Particle Emitters)**å¯ä»¥å®ç°çš„è§†è§‰æ•ˆæœçš„å‡ ä¸ªç¤ºä¾‹ï¼š

![image-20181205153401675](https://ws2.sinaimg.cn/large/006tNbRwgy1fxvwnp7bozj30bh05zq48.jpg)

åœ¨[ç³»ç»Ÿå­¦ä¹ iOSåŠ¨ç”»ä¹‹ä¸€ï¼šè§†å›¾åŠ¨ç”»](Section_I.md#4-ç»ƒä¹ è§†å›¾åŠ¨ç”»)çš„ç¬¬4ã€5ç« èŠ‚çš„**Flight Info**é¡¹ç›®ä¸­ä½¿ç”¨è¿‡é›ªèŠ±â„ï¸çš„æ•ˆæœï¼Œä½†æ²¡æœ‰è¯´æ˜æ€ä¹ˆä½¿ç”¨ï¼Œæœ¬ç« å°†å•ç‹¬å­¦ä¹ é›ªèŠ±â„ï¸æ•ˆæœçš„åˆ¶ä½œã€‚



### åˆ›å»ºå‘å°„å™¨å±‚

æœ¬ç« èŠ‚å°†ä½¿ç”¨`CALayer`çš„å­ç±»`CAEmitterLayer`æ¥åˆ›å»ºç²’å­æ•ˆæœã€‚

> æ³¨æ„ï¼šæœ‰è®¸å¤šç”¨äºåˆ›å»ºç²’å­æ•ˆæœçš„ç¬¬ä¸‰æ–¹ç±»ï¼Œä½†å®ƒä»¬é€šå¸¸çš„ç›®æ ‡æ˜¯ä¸æ¸¸æˆæ¡†æ¶é›†æˆã€‚ å¯¹äºUIKitåº”ç”¨ç¨‹åºä¸­çš„ç²’å­åŠ¨ç”»ï¼Œ`CAEmitterLayer`æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒå†…ç½®å¹¶ä¸”æ˜“äºä½¿ç”¨ã€‚

æœ¬ç« èŠ‚çš„[å¼€å§‹é¡¹ç›®](README.md#å…³äºä»£ç ) **Snow Scene**ã€‚

æ‰“å¼€`ViewController.swift`å¹¶å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`çš„åº•éƒ¨ï¼š

```swift
let rect = CGRect(x: 0.0, y: 100.0, width: view.bounds.width, height: 50.0)
let emitter = CAEmitterLayer()
emitter.frame = rect
view.layer.addSublayer(emitter)
```

æ­¤ä»£ç åˆ›å»ºä¸€ä¸ªæ–°çš„`CAEmitterLayer`ï¼Œå°†å›¾å±‚çš„æ¡†æ¶è®¾ç½®ä¸ºå æ®å±å¹•çš„æ•´ä¸ªå®½åº¦ï¼Œå¹¶å°†å›¾å±‚å®šä½åœ¨å±å¹•é¡¶éƒ¨é™„è¿‘ã€‚
æ¥ä¸‹æ¥ï¼Œéœ€è¦è®¾ç½®è¦ä¸ç²’å­æ•ˆæœä¸€èµ·ä½¿ç”¨çš„å‘å°„å™¨ç±»å‹ã€‚
å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`ï¼š

```swift
emitter.emitterShape = kCAEmitterLayerRectangle
```

å‘å°„å™¨çš„å½¢çŠ¶é€šå¸¸ä¼šå½±å“åˆ›å»ºæ–°ç²’å­çš„åŒºåŸŸï¼Œä½†åœ¨æ‚¨åˆ›å»ºç±»ä¼¼3Dçš„ç²’å­ç³»ç»Ÿçš„æƒ…å†µä¸‹ï¼Œå®ƒä¹Ÿä¼šå½±å“å®ƒä»¬çš„zä½ç½®ã€‚
ä»¥ä¸‹æ˜¯ä¸‰ç§æœ€ç®€å•çš„å‘å°„å™¨å½¢çŠ¶ï¼š

#### 1.ç‚¹å½¢çŠ¶

`kCAEmitterLayerPoint`çš„å‘å°„å™¨å½¢çŠ¶ä¼šå¯¼è‡´æ‰€æœ‰ç²’å­åœ¨åŒä¸€ç‚¹åˆ›å»ºï¼šå‘å°„å™¨çš„ä½ç½®ã€‚å¯¹äºæ¶‰åŠç«èŠ±æˆ–çƒŸèŠ±çš„æ•ˆæœï¼Œè¿™æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚

![image-20181205154724044](https://ws3.sinaimg.cn/large/006tNbRwgy1fxvx1m54wlj308903rq36.jpg)

ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡åœ¨åŒä¸€ç‚¹åˆ›å»ºæ‰€æœ‰ç²’å­ï¼Œå¹¶ä½¿å®ƒä»¬åœ¨æ¶ˆå¤±å‰æ²¿ä¸åŒæ–¹å‘é£è¡Œæ¥åˆ›å»ºç«èŠ±æ•ˆæœã€‚

#### 2.çº¿æ¡å½¢çŠ¶

`kCAEmitterLayerLine`å‘å°„å™¨å½¢çŠ¶ï¼Œæ˜¯æ²¿å‘å°„å™¨æ¡†æ¶é¡¶éƒ¨çº¿åˆ›å»ºæ‰€æœ‰ç²’å­ã€‚

è¿™æ˜¯ä¸€ç§å¯ç”¨äºç€‘å¸ƒæ•ˆæœçš„å‘å°„å™¨å½¢çŠ¶ï¼Œæ°´ç²’å­å‡ºç°åœ¨ç€‘å¸ƒçš„é¡¶éƒ¨å¹¶å‘ä¸‹ç§»åŠ¨ï¼š

![image-20181205154827937](https://ws3.sinaimg.cn/large/006tNbRwgy1fxvx2qka0oj308l02n74b.jpg)



#### 3.çŸ©å½¢å½¢çŠ¶
æœ€åï¼Œ`kCAEmitterLayerRectangle`ï¼Œé€šè¿‡åœ¨ç»™å®šçš„çŸ©å½¢åŒºåŸŸéšæœºåˆ›å»ºç²’å­ï¼š

![image-20181205155005520](https://ws2.sinaimg.cn/large/006tNbRwgy1fxvx4fb1joj308w02odfv.jpg)

è¿™ç§å‘å°„å™¨å½¢çŠ¶éå¸¸é€‚åˆè®¸å¤šä¸åŒçš„æ•ˆæœï¼ŒåŒ…æ‹¬ç¢³é…¸é¥®æ–™å’Œçˆ†ç±³èŠ±ä¸­çš„æ°”æ³¡ã€‚

ç”±äºç§¯é›ªä»æ•´ä¸ªå¤©ç©ºéšæœºå‡ºç°ï¼ŒçŸ©å½¢å‘å°„å™¨å½¢çŠ¶æ˜¯æœ¬ç« é¡¹ç›®çš„ä¸é”™é€‰æ‹©ã€‚



> æ³¨æ„ï¼šè¿˜æœ‰ä¸€äº›å‘å°„å™¨å½¢çŠ¶ - é•¿æ–¹ä½“ï¼Œåœ†å½¢å’Œçƒå½¢ - ä½†è¿™äº›è¶…å‡ºäº†æœ¬ç« çš„èŒƒå›´ã€‚ æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹Appleæ–‡æ¡£ä¸­çš„CAEmitterLayerç±»çš„å®˜æ–¹æ–‡æ¡£[**Emitter Shape**](https://developer.apple.com/documentation/quartzcore/caemitterlayer/emitter_shape)å‚è€ƒã€‚

### æ·»åŠ å‘å°„å™¨å¸§

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`çš„æœ«å°¾ï¼š

```swift
emitter.emitterPosition = CGPoint(x: rect.width/2, y: rect.height/2)
emitter.emitterSize = rect.siz
```

ç»„åˆå½¢çŠ¶ï¼Œä½ç½®å’Œå°ºå¯¸å±æ€§å®šä¹‰äº†å‘å°„å™¨æ¡†æ¶ã€‚ åœ¨è¿™é‡Œï¼Œå¯ä»¥å°†å‘å°„å™¨çš„ä½ç½®è®¾ç½®ä¸ºå›¾å±‚çš„ä¸­å¿ƒï¼Œå¹¶å°†å‘å°„å™¨å¤§å°è®¾ç½®ä¸ºç­‰äºå›¾å±‚çš„å¤§å°ã€‚
è¿™æ„å‘³ç€å‘å°„å™¨å ç”¨æ•´ä¸ªå±‚å¸§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20181205155701616](https://ws4.sinaimg.cn/large/006tNbRwgy1fxvxbn54o8j30d302oaab.jpg)

### åˆ›å»ºå‘å°„å™¨å•å…ƒ

ç°åœ¨å·²é…ç½®äº†å‘å°„å™¨çš„ä½ç½®å’Œå¤§å°ï¼Œå¯ä»¥ç»§ç»­æ·»åŠ **å‘å°„å™¨å•å…ƒ**ã€‚

å‘å°„å™¨å•å…ƒæ˜¯è¡¨ç¤ºä¸€ä¸ªç²’å­æºçš„æ•°æ®æ¨¡å‹ã€‚ å®ƒä¸`CAEmitterLayer`æ˜¯ä¸€ä¸ªå•ç‹¬çš„ç±»ï¼Œå› ä¸ºå•ä¸ªå‘å°„å™¨å±‚å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒã€‚

ä¾‹å¦‚ï¼Œåœ¨çˆ†ç±³èŠ±åŠ¨ç”»ä¸­ï¼Œä½ å¯ä»¥æœ‰ä¸‰ä¸ªä¸åŒçš„å•å…ƒæ¥è¡¨ç¤ºçˆ†ç±³èŠ±çš„ä¸åŒçŠ¶æ€ï¼šå®Œå…¨ç‚¸å¼€ï¼ŒåŠç‚¸å¼€å’Œé‚£äº›é¡½å›ºçš„æœªç‚¸å¼€ï¼š

![image-20181212211917849](https://ws2.sinaimg.cn/large/006tNbRwgy1fy49z422r4j309f04pq3o.jpg)

ä¹‹åå°†ä½¿ç”¨ä¸åŒçš„å½¢çŠ¶çš„â„ï¸å›¾ç‰‡ä»£è¡¨ä¸åŒçš„å‘å°„å™¨å•å…ƒ

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`çš„åº•éƒ¨ï¼š

```swift
let emitterCell = CAEmitterCell()
emitterCell.contents = UIImage(named: "flake.png")?.cgImage
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ‚¨åˆ›å»ºä¸€ä¸ªæ–°å•å…ƒæ ¼å¹¶å°†*flake.png*è®¾ç½®ä¸ºå…¶å†…å®¹ã€‚ `contents`å±æ€§åŒ…å«å°†ä»ä¸­åˆ›å»ºæ–°ç²’å­çš„æ¨¡æ¿ã€‚
ä¸‹é¢æ˜¯æ·±è‰²èƒŒæ™¯ä¸Šçš„æ”¾å¤§çš„*flake.png*å±å¹•æˆªå›¾ï¼š

![image-20181212212218466](https://ws4.sinaimg.cn/large/006tNbRwgy1fy4a29a3aij304l04lwee.jpg)

å‘å°„å™¨å°†åˆ›å»ºæ­¤å›¾åƒçš„å¤šä¸ªä¸åŒå‰¯æœ¬ä»¥æ¨¡ä»¿çœŸå®çš„é›ªèŠ±ã€‚

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`çš„åº•éƒ¨ï¼š

```swift
emitterCell.birthRate = 20
emitterCell.lifetime = 3.5
emitter.emitterCells = [emitterCell]
```

ä¸Šé¢çš„ä»£ç è¡¨ç¤ºæ¯ç§’åˆ›å»º20ä¸ªé›ªèŠ±ï¼Œå¹¶å°†å®ƒä»¬ä¿æŒåœ¨å±å¹•ä¸Š3.5ç§’ã€‚ è¿™æ„å‘³ç€åœ¨ä»»ä½•ç»™å®šæ—¶é—´å±å¹•ä¸Šå°†æœ‰70ä¸ªé›ªèŠ±ï¼Œé™¤äº†åŠ¨ç”»çš„æœ€åˆå‡ ç§’ä¹‹å‰ï¼Œæœ€æ—§çš„ç²’å­å¼€å§‹æ¶ˆå¤±ã€‚

æœ€åï¼Œä½¿ç”¨æ‰€æœ‰å‘å°„å™¨å•å…ƒçš„æ•°ç»„è®¾ç½®`emitterCells`å±æ€§ã€‚ è¯·è®°ä½ï¼Œå¯ä»¥æ‹¥æœ‰å¤šä¸ªå‘å°„å™¨å•å…ƒï¼Œç›®å‰åªæœ‰ä¸€ä¸ªã€‚ ä¸€æ—¦è®¾ç½®äº†å‘å°„å™¨å•å…ƒåˆ—è¡¨ï¼Œå‘å°„å™¨å°±ä¼šå¼€å§‹åˆ›å»ºç²’å­ã€‚

è¿è¡Œï¼Œçœ‹åˆ°æ•ˆæœï¼š

![](https://ws1.sinaimg.cn/large/006tNbRwgy1fxvxk5ojdzg308q03emxo.gif)

**flake.png**çš„å¤šä¸ªå‰¯æœ¬åœ¨3.5ç§’åæ˜¾ç¤ºå¹¶æ¶ˆå¤±ã€‚ ç„¶è€Œï¼Œé›ªæ˜¯å¥‡æ€ªçš„é™æ€ â€”â€” â„ï¸æ²¡æœ‰ç§»åŠ¨ã€‚

### æ§åˆ¶ç²’å­

ç›®å‰ï¼Œé›ªç²’å‡ºç°ï¼Œåœ¨ç©ºä¸­æ¼‚æµ®å‡ ç§’é’Ÿï¼Œç„¶åæ¶ˆå¤±ã€‚ é‚£ä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ— èŠ ï¼ ä¸‹ä¸€ä¸ªä»»åŠ¡æ˜¯è®©è¿™äº›æ¼«æ— ç›®çš„çš„ç²’å­ç§»åŠ¨èµ·æ¥ã€‚

#### æ”¹å˜ç²’å­æ–¹å‘

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`çš„åº•éƒ¨ï¼š

```swift
emitterCell.yAcceleration = 70.0
```

è¿™å°†åœ¨yæ–¹å‘ä¸Šå¢åŠ ä¸€ç‚¹åŠ é€Ÿåº¦ï¼Œå› æ­¤ç²’å­ä¼šåƒçœŸé›ªä¸€æ ·å‘ä¸‹æ¼‚ç§»ã€‚

è¿è¡Œæ•ˆæœï¼š

![](https://ws2.sinaimg.cn/large/006tNbRwgy1fxvxo702ikg308q0ck0w0.gif)

è¿™çœ‹èµ·æ¥æœ‰ç‚¹åƒé›ª â€”â€” ä½†é›ªå¾ˆå°‘ç›´çº¿ä¸‹é™ã€‚

è¦è§£å†³æ­¤é—®é¢˜ï¼Œå°±è¦å‘ç²’å­æ·»åŠ ä»¥ä¸‹æ°´å¹³åŠ é€Ÿåº¦ï¼š

```swift
emitterCell.xAcceleration = 10.0
```

è¿è¡Œï¼Œ é›ªèŠ±æœå‘å¯¹è§’çº¿æ–¹å‘ç§»åŠ¨ï¼š

![](https://ws3.sinaimg.cn/large/006tNbRwgy1fxvxqdqe1xg308q0ckte2.gif)

ä¸ºäº†äº§ç”Ÿæ¸©å’Œçš„å è½æ•ˆæœï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```swift
emitterCell.velocity = 20.0
emitterCell.emissionLongitude = .pi * -0.5
```

`velocity`æ˜¯åˆå§‹é€Ÿåº¦ã€‚

å‘å°„ç»åº¦ï¼ˆ`emissionLongitude`ï¼‰æ˜¯ç²’å­çš„åˆå§‹è§’åº¦ï¼Œé€Ÿåº¦å‚æ•°è®¾ç½®ç²’å­çš„åˆå§‹é€Ÿåº¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20181205161402211](https://ws4.sinaimg.cn/large/006tNbRwgy1fxvxtc4bsqj30a604nwep.jpg)

å†æ¬¡è¿è¡Œï¼Œæ•ˆæœï¼š

![](https://ws1.sinaimg.cn/large/006tNbRwgy1fxvxvnv1stg308q0ckakz.gif)

æ¯æ¬¡æ›´æ”¹æ—¶ï¼ŒåŠ¨ç”»çœ‹èµ·æ¥è¶Šæ¥è¶Šå¥½ã€‚ ä½†æ˜¯è¿™äº›ç²’å­çœ‹èµ·æ¥åƒé›ªèŠ±å¤§å°çš„æ€æˆ®æœºå™¨äººä¸€è‡´åœ°ç§»åŠ¨ã€‚ è¿™æ˜¯å› ä¸ºæ¯ä¸ªç²’å­å…·æœ‰å®Œå…¨ç›¸åŒçš„åˆå§‹è§’åº¦ï¼Œé€Ÿåº¦å’ŒåŠ é€Ÿåº¦ã€‚ éœ€è¦ä¸ºç²’å­åˆ›å»ºè¿‡ç¨‹æ·»åŠ ä¸€äº›éšæœºæ€§ã€‚

#### ä¸ºç²’å­æ·»åŠ éšæœºæ€§

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`ï¼š

```swift
emitterCell.velocityRange = 200.0
```

è¿™å‘Šè¯‰å‘å°„å™¨éšæœºèŒƒå›´çš„å€¼ã€‚ ç”±äºç²’å­åŠ¨ç”»çš„éšæœºèŒƒå›´åœ¨æœ¬ç« ä¸­ç»å¸¸ä½¿ç”¨ï¼Œå› æ­¤å€¼å¾—èŠ±äº›æ—¶é—´æ¥è§£é‡Šå®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚
æ‰€æœ‰ç²’å­çš„åˆå§‹é€Ÿåº¦éƒ½æ˜¯20; æ·»åŠ é€Ÿåº¦èŒƒå›´ä¸ºæ¯ä¸ªç²’å­åˆ†é…éšæœºé€Ÿåº¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![image-20181205162140512](https://ws1.sinaimg.cn/large/006tNbRwgy1fxvy1a688lj30at04hq3l.jpg)

æ¯ä¸ªç²’å­çš„é€Ÿåº¦å°†æ˜¯ï¼ˆ20-200ï¼‰= -180å’Œï¼ˆ20 + 200ï¼‰= 220ä¹‹é—´çš„éšæœºå€¼ã€‚å…·æœ‰è´Ÿåˆå§‹é€Ÿåº¦çš„ç²’å­æ ¹æœ¬ä¸ä¼šé£èµ·æ¥; ä¸€æ—¦å®ƒä»¬å‡ºç°åœ¨å±å¹•ä¸Šï¼Œå®ƒä»¬å°±ä¼šå¼€å§‹é£˜è½ã€‚ å…·æœ‰æ­£é€Ÿåº¦çš„ç²’å­å°†é¦–å…ˆé£èµ·ï¼Œç„¶åå‘ä¸‹é£˜è½ã€‚

è¿è¡Œï¼Œæ•ˆæœï¼š

![](https://ws2.sinaimg.cn/large/006tNbRwgy1fxvxzeqoewg308q0aodjr.gif)

å¥½å§ï¼Œé›ªèŠ±æ˜¯éšæœºçš„ï¼šä¸€äº›é›ªèŠ±è·³åˆ°å±å¹•çš„é¡¶éƒ¨è¾¹ç¼˜ï¼Œè€Œå…¶ä»–é›ªèŠ±åˆ™å‡ºç°ï¼Œå¾˜å¾Šä¸€ä¼šå„¿ï¼Œç„¶åå‘ä¸‹é£˜è½ã€‚



è®©åˆå§‹ç²’å­æ–¹å‘ä¹ŸéšæœºåŒ–ã€‚å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`ï¼š

```swift
emitterCell.emissionRange = .pi * 0.5
```


æœ€åˆï¼Œæ‰€æœ‰ç²’å­åˆå§‹å‘å°„è§’åº¦æ˜¯-Ï€/ 2ã€‚ ä¸Šé¢çš„ä»£ç è¡Œè¡¨æ˜å‘å°„å™¨åˆå§‹è§’åº¦ä¸ºï¼ˆ-Ï€/ 2  - Ï€/ 2ï¼‰= 180åº¦å’Œï¼ˆ-Ï€/ 2 +Ï€/ 2ï¼‰= 0åº¦èŒƒå›´å†…çš„ä¸€ä¸ªéšæœºè§’åº¦ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20181205162200057](https://ws4.sinaimg.cn/large/006tNbRwgy1fxvy1mot9qj30b204tdg3.jpg)

è¿è¡Œï¼Œæ•ˆæœï¼š

![](https://ws3.sinaimg.cn/large/006tNbRwgy1fxvy4c6vuwg308q0aogx7.gif)

ç°åœ¨è¿™æ˜¯éšæœºçš„ï¼ è™šæ‹Ÿæš´é£é›ªçœŸçš„å˜å¾—ç”ŸåŠ¨èµ·æ¥ã€‚

#### æ”¹å˜ç²’å­é¢œè‰²

`CAEmitterLayer`çš„è¿˜æœ‰ä¸€ä¸ªä¾¿åˆ©åŠŸèƒ½æ˜¯èƒ½å¤Ÿä¸ºç²’å­è®¾ç½®é¢œè‰²ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥å°†é›ªèŠ±æ·¡è“è‰²è€Œä¸æ˜¯é²œæ˜çš„ç™½è‰²ï¼Œå› ä¸ºè“è‰²é€šå¸¸ä¸é›¨ï¼Œæ°´ï¼Œé›ªæˆ–å†°æœ‰å…³ã€‚

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`çš„åº•éƒ¨ï¼š

```swift
emitterCell.color = UIColor(red: 0.9, green: 1.0, blue: 1.0, alpha: 1.0).cgColor
```



è¿™ç§å˜åŒ–çœ‹èµ·æ¥å¾ˆæœ‰è¶£ï¼Œä½†æ‰€æœ‰çš„é›ªèŠ±éƒ½æ˜¯ç»Ÿä¸€è“è‰²è°ƒã€‚ å¦‚æœå¯ä»¥éšæœºåŒ–æ¯ä¸ªé›ªèŠ±çš„é¢œè‰²ï¼Œè¿™ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ

éœ€è¦åšçš„å°±æ˜¯ä¸ºç²’å­é¢œè‰²å®šä¹‰ä¸‰ä¸ªç‹¬ç«‹çš„èŒƒå›´ï¼šçº¢è‰²ï¼Œç»¿è‰²å’Œè“è‰²å„ä¸€ä¸ªã€‚
å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`çš„æœ«å°¾ï¼š

```swift
emitterCell.redRange = 0.3
emitterCell.greenRange = 0.3
emitterCell.blueRange = 0.3
```


ä¸Šé¢çš„ä»£ç å¾ˆå¥½ç†è§£ï¼šç»¿è‰²å’Œè“è‰²æ˜¯0.7åˆ°1.3ä¹‹é—´çš„éšæœºå€¼ï¼Œä¹Ÿå°±æ˜¯0.7åˆ°1.0ã€‚ ç±»ä¼¼ï¼Œçº¢è‰²ä»‹äº0.6å’Œ1.0ä¹‹é—´ã€‚

è¿è¡Œï¼Œçœ‹åˆ°äº”å½©â„ï¸ï¼š



![](https://ws2.sinaimg.cn/large/006tNbRwgy1fxvyaloz0eg308q0aon60.gif)

0.3çš„èŒƒå›´æœ‰ç‚¹å¤§äº†ï¼Œè¿™æ˜¯ä¸ºäº†å±•ç¤ºæ•ˆæœï¼Œä¹‹åå¯ä»¥æ”¹ä¸º0.1ã€‚



#### éšæœºåŒ–ç²’å­å¤–è§‚

å³ä½¿åœ¨æ·»åŠ äº†æ‰€æœ‰è‡ªå®šä¹‰ä¹‹åï¼Œé›ªèŠ±å¤–è§‚çœ‹èµ·æ¥æ˜¯ä¸€æ ·çš„ï¼Œç°å®ä¸­ä¸ä¼šæ˜¯è¿™æ ·çš„ã€‚

ä¸‹é¢å°†ä½¿æ¯ä¸ªç²’å­éƒ½æˆä¸ºä¸€ä¸ªç¾ä¸½è€Œç‹¬ç‰¹çš„é›ªèŠ±ã€‚

è®©æ¯ä¸ªé›ªèŠ±å¤§å°æ˜¯éšæœºçš„ï¼Œå°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`ï¼š

```swift
emitterCell.scale = 0.8
emitterCell.scaleRange = 0.8
```

å°†åŸºæœ¬ç²’å­å¤§å°è®¾ç½®ä¸ºåŸå§‹å¤§å°çš„80ï¼…ï¼Œå¤§å°èŒƒå›´åœ¨ 0.0 - 1.6ä¹‹é—´ã€‚

ä¸ä»…å¯ä»¥è®¾ç½®é›ªèŠ±çš„åˆå§‹å¤§å°ï¼Œè¿˜å¯ä»¥åœ¨é›ªèŠ±è½ä¸‹æ—¶ä¿®æ”¹é›ªèŠ±çš„å¤§å°ã€‚åœ¨æ¥è¿‘åœ°é¢æ—¶ï¼Œâ„ï¸åœ¨æ¸©æš–çš„é›¾æ°”ä¸­ä¼šèåŒ–ã€‚

å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°`viewDidLoad()`ï¼š

```swift
emitterCell.scaleSpeed = -0.15
```

`scaleSpeed`å±æ€§è¡¨ç¤ºï¼Œç²’å­æŒ‰æ¯”ä¾‹æ¯ç§’ç¼©å°åŸå§‹å¤§å°çš„15ï¼…ã€‚

å¤§ç²’å­åœ¨ä»è§†çº¿ä¸­æ¶ˆå¤±ä¹‹å‰ä¼šå¤§å¹…æ”¶ç¼©ï¼Œè€Œå°ç²’å­ä¼šåœ¨å®ƒä»¬ç»“æŸå‰å®Œå…¨æ¶ˆå¤±ã€‚ä¸è¦å¿ƒç–¼ï¼Œè¿™åªæ˜¯ç”Ÿæ´»çš„é›ªèŠ±åœˆã€‚

è¿è¡Œï¼Œæ•ˆæœï¼Œè§‚å¯Ÿå•ä¸ªé›ªèŠ±å¤§å°çš„å˜åŒ–ï¼š

![](https://ws2.sinaimg.cn/large/006tNbRwgy1fxvykvnmcsg308q07cgp7.gif)




â„ï¸çœ‹ä¸Šå»æœ‰ç‚¹å°‘ï¼Œä¿®æ”¹`birthRate`ï¼š

```swift
emitterCell.birthRate = 150
```


è®¾ç½®â„ï¸çš„é€æ˜åº¦ï¼Œå°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°`viewDidLoad()`çš„åº•éƒ¨ï¼š

```swift
emitterCell.alphaRange = 0.75
emitterCell.alphaSpeed = -0.15
```

è®¾ç½®äº†ä¸€ä¸ªalphaèŒƒå›´ï¼Œä»0.25åˆ°1.0çš„ä¸Šé™å€¼ã€‚ `alphaSpeed`ä¸`scaleSpeed`éå¸¸ç›¸ä¼¼ï¼Œå¯ä»¥éšæ—¶é—´æ›´æ”¹ç²’å­çš„alphaå€¼ã€‚

è¿è¡Œï¼ŒæŸ¥çœ‹æ•ˆæœï¼š

![](https://ws3.sinaimg.cn/large/006tNbRwgy1fxvyqdjsy0g308q07ctou.gif)



ç›®å‰å·²ç»æ¶µç›–äº†`CAEmitterCell`æä¾›çš„å¤§éƒ¨åˆ†å†…å®¹ï¼Œä¸‹é¢å†…å®¹æ˜¯å…³äºâ„ï¸çš„ä¸€äº›ç»†èŠ‚ã€‚



### é›ªèŠ±çš„ç»†èŠ‚
åœ¨`viewDidLoad()`ä¸­æ‰¾åˆ°è®¾ç½®`emissionLongitude`å¹¶å°†å…¶æ›´æ”¹ä¸ºä»¥ä¸‹å†…å®¹çš„è¡Œï¼š

```swift
emitterCell.emissionLongitude = -.pi
```

è¯·è®°ä½ï¼Œå‘å°„ç»åº¦æ˜¯ç²’å­çš„èµ·å§‹è§’åº¦ã€‚ è¿™ç§å˜åŒ–ä¼šè®©é›ªèŠ±æ—‹è½¬ä¸€ä¸‹ï¼Œä»¿ä½›è¢«é£å¹ä¸€ä¸‹ä¸€æ ·ã€‚
æ¥ä¸‹æ¥ï¼Œåœ¨æ‰¾åˆ°å£°æ˜`rect`çš„è¡Œå¹¶æŒ‰å¦‚ä¸‹æ–¹å¼ä¿®æ”¹å®ƒï¼š

```swift
let rect = CGRect(x: 0.0, y: -70.0, width: view.bounds.width, height: 50.0)
```

è¿™ä¼šå°†å‘å°„å™¨ç§»å‡ºå±å¹•ï¼Œç”¨æˆ·å°†æ— æ³•çœ‹åˆ°ç²’å­æ¥è‡ªä½•å¤„ã€‚ä¹‹å‰è®©ç²’å­å‘å°„åœ¨å±å¹•ä¸­ï¼Œæ˜¯ä¸ºäº†å±•ç¤ºè¯´æ˜ã€‚

æœ€åï¼Œå°†ä»¥ä¸‹ä½ä»£ç æ·»åŠ åˆ°`viewDidLoad()`ä»¥éšæœºåŒ–é›ªèŠ±åœ¨å±å¹•ä¸Šä¿ç•™çš„æ—¶é—´é•¿åº¦ï¼š

```swift
emitterCell.lifetimeRange = 1.0
```

è¿™ä¼šå°†æ¯ä¸ªé›ªèŠ±çš„ç”Ÿå‘½å‘¨æœŸè®¾ç½®ä¸º2.5åˆ°4.5ç§’ä¹‹é—´çš„éšæœºå€¼ã€‚



è™½ç„¶æœ¬ç« æ˜¯ä¸€`CAEmitterLayer`ä¸ºåŸºç¡€ï¼Œè¯´æ˜äº†åˆ¶ä½œç²’å­æ•ˆæœçš„å¾ˆå¤šç»†èŠ‚ï¼Œä½†æ˜¯æ¯ä¸ªæ¦‚å¿µéƒ½å®Œå…¨é€‚ç”¨äºå…¶ä»–ç²’å­ç³»ç»Ÿã€‚æ— è®ºæ˜¯**SpriteKit**ï¼Œ**Unity**è¿˜æ˜¯ä»»ä½•å…¶ä»–è‡ªå®šä¹‰ç²’å­å‘å°„å™¨ï¼ŒåŸç†éƒ½åŸºæœ¬ä¸Šå·®ä¸å¤šã€‚

æœ¬ç« ç›®å‰æ•ˆæœï¼š

![](https://ws3.sinaimg.cn/large/006tNbRwgy1fxvyxeh9d3g308q09ogyt.gif)





### æ·»åŠ æ›´å¤šå•å…ƒ

è¿™ä¸€éƒ¨åˆ†åªæ˜¯ä¸ºäº†å­¦ä¹ æ›´å¤šç²’å­ç³»ç»Ÿçš„çŸ¥è¯†ï¼ŒçœŸå®çš„é›ªæ™¯ä¸æ˜¯è¿™æ ·çš„ï¼ŒğŸ˜ã€‚



æˆ‘åˆæ·»åŠ äº†ä¸‰ç§ä¸åŒâ„ï¸å•å…ƒï¼š

```swift
    //cell #2
    let cell2 = CAEmitterCell()
    cell2.contents = UIImage(named: "flake2.png")?.cgImage
    cell2.birthRate = 50
    cell2.lifetime = 2.5
    cell2.lifetimeRange = 1.0
    cell2.yAcceleration = 50
    cell2.xAcceleration = 50
    cell2.velocity = 80
    cell2.emissionLongitude = .pi
    cell2.velocityRange = 20
    cell2.emissionRange = .pi * 0.25
    cell2.scale = 0.8
    cell2.scaleRange = 0.2
    cell2.scaleSpeed = -0.1
    cell2.alphaRange = 0.35
    cell2.alphaSpeed = -0.15
    cell2.spin = .pi
    cell2.spinRange = .pi
    
    //cell #3
    let cell3 = CAEmitterCell()
    cell3.contents = UIImage(named: "flake3.png")?.cgImage
    cell3.birthRate = 20
    cell3.lifetime = 7.5
    cell3.lifetimeRange = 1.0
    cell3.yAcceleration = 20
    cell3.xAcceleration = 10
    cell3.velocity = 40
    cell3.emissionLongitude = .pi
    cell3.velocityRange = 50
    cell3.emissionRange = .pi * 0.25
    cell3.scale = 0.8
    cell3.scaleRange = 0.2
    cell3.scaleSpeed = -0.05
    cell3.alphaRange = 0.5
    cell3.alphaSpeed = -0.05
    
    //cell #4
    let cell4 = CAEmitterCell()
    cell4.contents = UIImage(named: "flake4.png")?.cgImage
    cell4.birthRate = 10
    cell4.lifetime = 5.5
    cell4.lifetimeRange = 1.0
    cell4.yAcceleration = 25
    cell4.xAcceleration = 30
    cell4.velocity = 20
    cell4.emissionLongitude = .pi
    cell4.velocityRange = 30
    cell4.emissionRange = .pi * 0.25
    cell4.scale = 0.8
    cell4.scaleRange = 0.2
    cell4.scaleSpeed = -0.05
    cell4.alphaRange = 0.5
    cell4.alphaSpeed = -0.05
    
    emitter.emitterCells = [emitterCell, cell2, cell3, cell4]
```



> æ³¨ï¼šå¯èƒ½éœ€è¦åœ¨çœŸæœºæ‰èƒ½çœ‹åˆ°æµç•…çš„æ•ˆæœ

æ•ˆæœï¼š

![](https://ws4.sinaimg.cn/large/006tNbRwgy1fxvzhofmleg30ku112b2a.gif)







## 27-UIImageViewçš„å¸§åŠ¨ç”»



æœ€åä¸€ç« å­¦ä¹ å¦‚ä½•åˆ›å»ºä¸€ç§éå¸¸ç‰¹æ®Šçš„åŠ¨ç”»äº†ã€‚**å¸§åŠ¨ç”»(Frame Animation)**æ˜¯æˆ‘ä»¬å°æ—¶å€™å–œæ¬¢çš„åŠ¨ç”»ç±»å‹ï¼Œä»Šå¤©å¯èƒ½ä»ç„¶å¾ˆå–œæ¬¢ï¼›è¿ªæ–¯å°¼çš„Duck Talesï¼ŒHanna-Barberaçš„Tomå’ŒJerryä»¥åŠFlintstonesæ¼«ç”»éƒ½æ˜¯è¿™ç§åˆ›ä½œæ–¹å¼ã€‚

**å¸§åŠ¨ç”»**ä¹Ÿæ˜¯ç”¨æ¥ä¸ºæ¸¸æˆä¸­çš„è§’è‰²åˆ¶ä½œåŠ¨ç”»çš„åŠ¨ç”»ã€‚ä»…ä»…å°†é™æ€æ¸¸æˆè§’è‰²ä»ä¸€ä¸ªä½ç½®è½¬æ¢ä¸ºå¦ä¸€ä¸ªä½ç½®æ˜¯ä¸å¤Ÿçš„ã€‚éœ€è¦ç§»åŠ¨è§’è‰²çš„è„šæˆ–æ—‹è½¬é£æœºçš„èºæ—‹æ¡¨ä»¥ç»™å‡ºé€¼çœŸçš„è¿åŠ¨æ„Ÿã€‚

è¦åˆ›å»ºè§’è‰²ç§»åŠ¨çš„æ•ˆæœï¼Œå¯ä»¥å°†åŠ¨ç”»åˆ†è§£ä¸ºå¸§ï¼Œè¿™äº›å¸§æ˜¯è¡¨ç¤ºåŠ¨ä½œä¸åŒé˜¶æ®µçš„é™æ­¢å›¾åƒã€‚å½“å¿«é€Ÿæ˜¾ç¤ºå¸§æ—¶ï¼Œä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ˜¾ç¤ºå¸§ï¼Œçœ‹èµ·æ¥è§’è‰²æ­£åœ¨ç§»åŠ¨ï¼š

![image-20181205172245592](https://ws3.sinaimg.cn/large/006tNbRwgy1fxvzsuxv7yj30bt0370tb.jpg)





### å¼€å§‹é¡¹ç›®

æœ¬ç« èŠ‚çš„[å¼€å§‹é¡¹ç›®](README.md#å…³äºä»£ç ) æ˜¯**SouthPoleFun**ï¼Œæ‰“å¼€`Main.storyboard`æŸ¥çœ‹æœ€åˆçš„æ¸¸æˆåœºæ™¯ï¼š

![image-20181212232053788](https://ws4.sinaimg.cn/large/006tNbRwgy1fy4dhn05hfj30ao05v74v.jpg)

ç»“æ„å¾ˆç®€å•ï¼Œä¸€ä¸ªèƒŒæ™¯å›¾ç‰‡ï¼Œå‘å·¦ã€å‘å³ä¸¤ä¸ªæŒ‰é’®ï¼Œä¸€ä¸ªæ»‘åŠ¨æŒ‰é’®ï¼Œä¸€ä¸ªä¼é¹…å›¾åƒè§†å›¾ã€‚

`ViewController.swift`ä¸­`actionLeft(_:)`ï¼Œ`actionRight(_:)`åˆ†åˆ«è¿æ¥å·¦å³ä¸¤ä¸ªæŒ‰é’®ï¼Œ`actionSlide(_:)`è¿æ¥æ»‘åŠ¨æŒ‰é’®ã€‚`penguin`å’Œ`slideButton`åˆ†åˆ«æ˜¯ä¼é¹…å›¾åƒå’Œæ»‘åŠ¨æŒ‰é’®çš„æ¥å£ã€‚

**Images.xcassets**ä¸­åŒ…æ‹¬ä¼é¹…ğŸ§ä¸¤å¼ æ»‘åŠ¨å›¾ç‰‡å’Œå››å¼ èµ°åŠ¨å›¾ç‰‡ï¼š

![image-20181212232641383](https://ws4.sinaimg.cn/large/006tNbRwgy1fy4dno9616j30fy04waaj.jpg)



### è®¾ç½®å¸§åŠ¨ç”»

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`ViewController`ä¸­çš„`loadWalkAnimation()`æ–¹æ³•ï¼š

```swift
penguin.animationImages = walkFrames
penguin.animationDuration = animationDuration / 3
penguin.animationRepeatCount = 3
```

`animationImages`ï¼šå­˜å‚¨å¸§åŠ¨ç”»çš„æ‰€æœ‰å¸§å›¾åƒã€‚

`animationDuration`ï¼šè¿™å‘Šè¯‰UIKitåŠ¨ç”»çš„ä¸€æ¬¡è¿­ä»£åº”è¯¥æŒç»­å¤šé•¿æ—¶é—´ï¼›å› ä¸ºæ‚¨å°†é‡å¤åŠ¨ç”»ä¸‰æ¬¡ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œæ‰€ä»¥å°†å…¶è®¾ç½®ä¸ºæ€»`animationDuration`çš„ä¸‰åˆ†ä¹‹ä¸€ã€‚

`animationRepeatCount`ï¼šæ§åˆ¶åŠ¨ç”»çš„é‡å¤æ¬¡æ•°ã€‚



ä¹‹åï¼Œéœ€è¦ä»è§†å›¾æ§åˆ¶å™¨ä¸­çš„`viewDidLoad()`è°ƒç”¨`loadWalkAnimation()`ï¼Œä»¥ä¾¿æ¯å½“ç©å®¶ç‚¹å‡»å·¦ç®­å¤´æŒ‰é’®æ—¶å›¾åƒè§†å›¾å°±ä¼šå‡†å¤‡å°±ç»ªã€‚
å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`viewDidLoad()`çš„åº•éƒ¨ï¼š

```swift
loadWalkAnimation()
```

å“¦ - ç‚¹å‡»å·¦ç®­å¤´æŒ‰é’®æ—¶æ²¡æœ‰ä»»ä½•ååº”ã€‚ ä½ åšé”™äº†ä»€ä¹ˆå—ï¼Ÿ æ²¡æœ‰; æ‚¨åªä¸ºå¸§åŠ¨ç”»é…ç½®äº†å›¾åƒè§†å›¾ï¼Œä½†æ‚¨ä»æœªå¯åŠ¨è¿‡åŠ¨ç”»ã€‚ å¦‚æœä¸å¯åŠ¨å¸§åŠ¨ç”»ï¼Œå›¾åƒè§†å›¾å°†ç»§ç»­æ˜¾ç¤ºå…¶å›¾åƒå±æ€§çš„å†…å®¹ã€‚
æ˜¯æ—¶å€™è®©è¿™åªä¼é¹…è¹’è·šäº†ã€‚
å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`actionLeft(_:)`ï¼š

```swift
isLookingRight = false
```

è¿™æ˜¯å·¦å³æ–¹å‘çš„åˆ¤æ–­ã€‚ç”±äºæ¯æ¬¡æ›´æ”¹ä¼é¹…çš„æ–¹å‘æ—¶éƒ½éœ€è¦æ›´æ–°ä¼é¹…çš„è½¬æ¢å’ŒæŒ‰é’®çš„è½¬æ¢ï¼Œå› æ­¤éœ€è¦å‘`isLookingRight`æ·»åŠ [å±æ€§è§‚å¯Ÿå™¨](https://docs.swift.org/swift-book/LanguageGuide/Properties.html)ï¼š

```swift
var isLookingRight: Bool = true {
    didSet {
        let xScale: CGFloat = isLookingRight ? 1 : -1
        penguin.transform = CGAffineTransform(scaleX: xScale, y: 1)
        slideButton.transform = penguin.transform
    }
}
```

ä¸Šé¢ä»£ç å°†ä¼é¹…æŒ‰é’®å›¾ç‰‡çš„xè½´åˆ»åº¦è®¾ç½®ä¸º1æˆ–-1ï¼Œå…·ä½“å–å†³äº`isLookingRight`çš„å€¼ã€‚ ç„¶åè®¾ç½®è¯¥è½¬æ¢ï¼Œæ¥å®ç°ç¿»è½¬è§†å›¾ï¼Œè®©ä¼é¹…å¯ä»¥é¢å‘æ­£ç¡®çš„æ–¹å‘ï¼š

![image-20181205174828259](https://ws2.sinaimg.cn/large/006tNbRwgy1fxw0jlkmdqj30bl04qaak.jpg)

ç°åœ¨éœ€è¦è°ƒç”¨åŠ¨ç”»ä»£ç ã€‚ åœ¨`actionLeft(_:)`ä¸­ç»§ç»­æ·»åŠ ï¼š

```swift
 penguin.startAnimating()
```

å½“è°ƒç”¨`startAnimating()`æ—¶ï¼Œå›¾åƒè§†å›¾ä¼šåœ¨é…ç½®åŠ¨ç”»æ—¶æ’­æ”¾åŠ¨ç”»ï¼š`animationImages`æ•°ç»„ä¸­çš„æ¯ä¸ªå¸§æŒ‰é¡ºåºæ˜¾ç¤ºï¼Œæ€»å…±è¶…è¿‡1ç§’ã€‚
è¿è¡Œï¼Œ ç‚¹å‡»å·¦ç®­å¤´æŒ‰é’®ï¼ŒæŸ¥çœ‹ä¼é¹…åœ¨è¡ŒåŠ¨ï¼š

![](https://ws2.sinaimg.cn/large/006tNbRwgy1fxw0ncwkelg30bq08r0th.gif)



### è®¾ç½®è§†å›¾åŠ¨ç”»

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`actionLeft(_:)`ï¼š

```swift
UIView.animate(withDuration: animationDuration, delay: 0, options: .curveEaseOut, animations: {
    self.penguin.center.x -= self.walkSize.width
}, completion: nil)
```

ä½¿ç”¨æ­¥è¡Œå›¾åƒçš„å®½åº¦æ¥ç¡®å®šä¼é¹…åœ¨åŠ¨ç”»æ’­æ”¾æ—¶é—´å†…ç§»åŠ¨çš„è·ç¦»ã€‚

è¿è¡Œï¼Œæ•ˆæœï¼š

![](https://ws4.sinaimg.cn/large/006tNbRwgy1fxw0r4e2uug30bq08r0tw.gif)




å‘å³æŒ‰é’®å·®ä¸å¤šï¼Œå°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`actionRight(_:)`ï¼š

```swift
isLookingRight = true
penguin.startAnimating()

UIView.animate(withDuration: animationDuration, delay: 0, options: .curveEaseOut, animations: {
    self.penguin.center.x += self.walkSize.width
}, completion: nil)
```



### æ»‘åŠ¨å¸§åŠ¨ç”»

ä¸ä¹‹å‰å·¦å³ç§»åŠ¨çš„åŠ¨ç”»ç±»ä¼¼ã€‚

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`loadSlideAnimation()`ä»¥åŠ è½½æ–°çš„å¸§åºåˆ—ï¼š

```swift
penguin.animationImages = slideFrames
penguin.animationDuration = animationDuration
penguin.animationRepeatCount = 1
```


å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`actionSlide(_:)`ï¼š

```swift
loadSlideAnimation()
penguin.startAnimating()
```

è¿è¡Œï¼Œå¯ä»¥çœ‹åˆ°ä¼é¹…è·³åˆ°è‡ªå·±è‚šå­ä¸Šæ»‘åŠ¨ã€‚

ä½†åŠ¨ç”»æœ‰ä¸€ç‚¹å¥‡æ€ªï¼Œå› ä¸ºä¸¤ä¸ªåŠ¨ç”»ä¹‹é—´çš„å¸§å›¾åƒä¸åŒï¼š

![image-20181205180338215](https://ws3.sinaimg.cn/large/006tNbRwgy1fxw0ze1pouj308v047aap.jpg)

å¼€å§‹å¸§å›¾åƒä¸º108 x 96ï¼Œè€Œæ»‘åŠ¨æ—¶å›¾åƒä¸º93 x 75.å¦‚æœå®ƒä»¬çš„å¤§å°ç›¸åŒï¼Œåˆ™æ¯ä¸ªå›¾åƒä¸­çš„ç©ºç™½ç©ºé—´æœ€ç»ˆä¼šå˜å¤§ã€‚æƒ³è±¡ä¸€ä¸ªå…·æœ‰äº”ä¸ªï¼Œå…­ä¸ªæˆ–æ›´å¤šå¸§åŠ¨ç”»çš„è§’è‰²;ä½ æœ€ç»ˆä¼šå¾—åˆ°å·¨å¤§çš„å›¾åƒå°ºå¯¸ï¼Œä»¥é€‚åº”æ‰€æœ‰å¯èƒ½çš„åŠ¨ç”»å¸§ã€‚

> æ³¨æ„ï¼šæ­¤é—®é¢˜çš„ä¸€ä¸ªç®€å•è§£å†³æ–¹æ¡ˆæ˜¯å°†å›¾åƒè§†å›¾çš„å†…å®¹æ¨¡å¼ä»å…¶é»˜è®¤å€¼â€œAspect Fillâ€è®¾ç½®ä¸ºâ€œCenterâ€æˆ–â€œTop Leftâ€ã€‚ä½†è¿™ä¸æ˜¯å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä¸‹é¢å®ç°ä¸€ä¸ªç¨å¾®ä¸åŒä¸”æ›´çµæ´»çš„è§£å†³æ–¹æ¡ˆã€‚

æ‰‹åŠ¨è°ƒæ•´å›¾åƒè§†å›¾çš„å¤§å°å¹¶é‡æ–°å®šä½ï¼Œä»¥åˆ›å»ºæ¼‚äº®æµåŠ¨çš„ç²¾ç¾åŠ¨ç”»ã€‚



é¦–å…ˆï¼Œéœ€è¦åœ¨æ’­æ”¾ä»»ä½•åŠ¨ç”»ä¹‹å‰è®¾ç½®æ‰€éœ€çš„å›¾åƒè§†å›¾å¸§; è¿™å¯ä»¥ç¡®ä¿æ¡†æ¶åœ¨å±å¹•ä¸Šå¯è§æ—¶å°ºå¯¸æ­£ç¡®ã€‚
å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`actionSlide(_:)ï¼Œå°±åœ¨æ‚¨å¼€å§‹åŠ¨ç”»çš„ä½ç½®ä¹‹å‰ï¼š

```swift
penguin.frame = CGRect(x: penguin.frame.origin.x,
                       y: penguinY + (walkSize.height - slideSize.height),
                       width: slideSize.width,
                       height: slideSize.height)
```

æ­¤ä»£ç å°†ä¼é¹…å›¾åƒè§†å›¾å‘ä¸‹ç§»åŠ¨ä¸€ç‚¹ä»¥è¡¥å¿å¹»ç¯ç‰‡åŠ¨ç”»çš„è¾ƒçŸ­å¸§ï¼Œå¹¶è°ƒæ•´å›¾åƒè§†å›¾çš„å¤§å°ä»¥åŒ¹é…`slideSize`ã€‚
`slideSize`åŒ…å«*slide01.png*çš„å¤§å°ï¼›` viewDidLoad()`å·²åŒ…å«è·å–å›¾åƒçš„ä»£ç ã€‚

ç°åœ¨å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°`actionSlide(_:)`çš„åº•éƒ¨ï¼š

```swift
UIView.animate(withDuration: animationDuration - 0.02, delay: 0.0, options: .curveEaseOut, animations: {
    self.penguin.center.x += self.isLookingRight ? self.slideSize.width : -self.slideSize.width
}, completion: { _ in

})
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªè§†å›¾åŠ¨ç”»æ¥ç§»åŠ¨ä¼é¹…å›¾åƒè§†å›¾å¹¶æ¨¡æ‹Ÿè·³è½¬åŠ¨ä½œã€‚ 

åœ¨ä¸Šé¢çš„é¢å®ŒæˆåŠ¨ç”»é—­åŒ…ä¸­æ·»åŠ ï¼š

```swift
self.penguin.frame = CGRect(x: self.penguin.frame.origin.x,
                            y: self.penguinY,
                            width: self.walkSize.width,
                            height: self.walkSize.height)
self.loadWalkAnimation()
```



æœ€åï¼Œè¿è¡Œï¼Œæ•ˆæœï¼š

![](https://ws2.sinaimg.cn/large/006tNbRwgy1fxw1bdetvhg30fm08sn0q.gif)





ä½¿ç”¨UIImageViewçš„å¸§åŠ¨ç”»å¾ˆç®€å•ï¼Œä½†è¿™æ˜¯æˆ‘ä»¬åŠ¨ç”»æŠ€èƒ½çš„ä¸€ä¸ªå¾ˆå¥½çš„è¡¥å……ã€‚



